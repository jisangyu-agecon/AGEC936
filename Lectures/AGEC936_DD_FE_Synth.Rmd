---
title: "AGEC 936 - Module 4"
subtitle: "Difference-in-Differences (DID)<br>Two-way Fixed Effects (TWFE)<br>Synthetic Control Methods"
author: "Jisang Yu<br>Kansas State University"
date: "4/19/2021"
output:
 slidy_presentation:
   font_adjustment: -1
   toc: false
   footer: "AGEC 936 - Jisang Yu"
bibliography: references.bib
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

# This week
* (Previous week: [Panel data introduction](https://jisangyu-agecon.github.io/AGEC936/Lectures/AGEC936_Panel_Intro.html))
* Difference-in-differences (DID) in potential outcome framework
* Two-way Fixed Effects (TWFE)
* Parallel trend assumption
* Staggered treatment timing: When can TWFE fail and some alternatives
* Synthetic control methods

# Potential outcome representation
* With a binary treatment, $d_i=\{0,\;1\}$, let us denote the outcome of interest as
$$
y_i(0)\;\text{if}\;d_i=0 \\
y_i(1)\;\text{if}\;d_i=1
$$
* With an *ideal* research design, the difference, 
$$
y_i(1)-y_i(0)
$$ 
can be interpreted as **causal effect** [@rubin1974estimating]. In practice, **do we observe both $y_i(0)$ and $y_i(1)$**? 
* The *ideal* average treatment (causal) effect is defined as
$$
E(y_i(1)-y_i(0))=E(y_{i}(1))-E(Y_{i}(0)).
$$
* Instead, we observe 
$$
y_i=y_i(0)+(y_i(1)-y_i(0))d_{i}.
$$
and can estimate
$$
E(y_{i}|d_i=1)-E(y_{i}|d_i=0).
$$
* What happens if $y_i(0)$, $y_i(1)$, and $d_i$ are not independent?
$$
E(y_{i}|d_i=1)-E(y_{i}|d_i=0) \\
=E(y_i(0)+(y_i(1)-y_i(0))|d_i=1)-E(y_i(0)|d_i=0) \\
=\underbrace{\{E(y_i(1)|d_i=1)-E(y_i(0)|d_i=1)\}}_{ATT}+\underbrace{\{E(y_i(0)|d_i=1)-E(y_i(0)|d_i=0)\}}_{(Selection)\; Bias}.
$$
If the **Bias** term is non-zero, what should we do?

# Difference-in-differences (DID)
* **Set-up** 
Let's consider 2 x 2 case (two-period, $t={1,2}$, N-unit, $i={1,...,N}$, and two-group, $g={T,C}$ case). Potential outcomes are
$$
y_{it}(0)=\alpha_i+\gamma_t+\varepsilon_{it} \\
y_{it}(1)=\alpha_i+\gamma_t+\tau_i d_{it}+\varepsilon_{it}
$$
For $i \in T$, $d_{i1}=0$ and $d_{i2}=1$ and for $i \in C$, $d_{i1}=0$ and $d_{i2}=0$.
* **Average Treatment Effect on Treated (ATT)**
$$
E(\tau_i|i \in T)
$$
This is normally what we want!
* **First differences**
$$
y_{i2}-y_{i1}=(\alpha_i+\gamma_2+\tau_i d_{i2}+\varepsilon_{i2}) - (\alpha_i+\gamma_1+\tau_i d_{i1}+\varepsilon_{i1}) \\
=(\gamma_2-\gamma_1)+\tau_i (d_{i2}-d_{i1})+(\varepsilon_{i2}-\varepsilon_{i1})
$$
Conditional expectations by group:
$$
E(y_{i2}-y_{i1}|i \in T)=(\gamma_2-\gamma_1)+E(\tau_i (d_{i2}-d_{i1})|i \in T)+E(\varepsilon_{i2}-\varepsilon_{i1}|i \in T) \\
=(\gamma_2-\gamma_1)+E(\tau_i |i \in T)
$$
$$
E(y_{i2}-y_{i1}|i \in C)=(\gamma_2-\gamma_1)+E(\tau_i (d_{i2}-d_{i1})|i \in C)+E(\varepsilon_{i2}-\varepsilon_{i1}|i \in C) \\
=(\gamma_2-\gamma_1)
$$
* **Difference-in-differences**
$$
E(y_{i2}-y_{i1}|i \in T)-E(y_{i2}-y_{i1}|i \in C)
=\{(\gamma_2-\gamma_1)+E(\tau_i |i \in T)\}-(\gamma_2-\gamma_1) \\
=E(\tau_i |i \in T)
$$

# Two-way Fixed Effects (TWFE)
* **Two-way Fixed Effects** We can also use the following regression equation:
$$
y_{it}=\alpha_i+\gamma_t+\tau_i d_{it}+\varepsilon_{it}
$$
With $T=2$, the OLS estimator for the equation above, denoted by $\hat{\tau}_{FE}$, is consistently estimating *ATT*. Need the following assumptions:
  + Strict exogeneity
  + Parallel trend 
* **"Parallel-trend" assumption**: Revisit the DinD expression,
$$
E(y_{i2}-y_{i1}|i \in T)-E(y_{i2}-y_{i1}|i \in C)
=\{(\gamma_2-\gamma_1)+E(\tau_i |i \in T)\}-(\gamma_2-\gamma_1) \\
=E(\tau_i |i \in T)
$$
This is valid if 
$$
\gamma_{it}=\gamma_{t}\;\text{for}\;\forall\;i.
$$

# A simulation: the equivalence between DID and TWFE
* **DGP**
$$
y_{it}=5+2(t-1)+4d_{it}+0.2x_{i}+\varepsilon_{it}\;\;\text{with}\;\;i=\{1,2,...,500\}\;\;\text{and}\;\;t=\{1,2\}
$$
$$
d_{i1}=0,\;\;
d_{i2}= \begin{cases}
1\;\;\text{if}\;\;i=\{1,...,250\} \\
0\;\;\text{otherwise}
\end{cases}
$$
$$
x_{i}=\begin{cases}
0.5+u_{i}\;\;\text{if}\;\;i=\{1,...,250\} \\
u_{i}\;\;\text{otherwise}
\end{cases}
\;\;\text{and}\;\;u_i \sim N(0,1)
$$

```{r simple, collectcode=TRUE}
library(lmtest)
library(sandwich)
# set seed
set.seed(11123)

# 100 units
N<-500
unit<-1:500

# Define treatment effect
tau<-4

# Treatment groups
d <- c(rep(0, N/2), rep(1, N/2))

# DGP
X <- d*0.5+rnorm(N)
# Pre
Y_1 <- 5+0.2*X+0.3*rnorm(N)
# Post
Y_2 <- 5+2+0.2*X+tau*d+0.3*rnorm(N)

# DinD
(mean(Y_2[d == 1]) - mean(Y_1[d == 1])) - (mean(Y_2[d == 0]) - mean(Y_1[d == 0]))
```

```{r simple2, collectcode=TRUE}
# Two-way Fixed Effects
# Data prep
dind_data <- data.frame("Y"=c(Y_1, Y_2),
                        "Treat"=c(rep(0,N), d),
                        "Unit"=c(unit, unit),
                        "Time"=c(rep(1,N), rep(2,N)))

# Two-way FE regression
TWFE <- lm(Y ~ Treat + as.factor(Time) + as.factor(Unit), data = dind_data)
Results<-coeftest(TWFE, vcov=vcovHC)
Results[2,]
```

**With $T=2$, DID and TWFE are numerically identical**

# Violation of parellel-trend assumption
* **DGP**
$$
y_{it}=5+2(t-1)(d_{it}+1)+4d_{it}+0.2x_{i}+\varepsilon_{it}\;\;\text{with}\;\;i=\{1,2,...,500\}\;\;\text{and}\;\;t=\{1,2\}
$$
$$
d_{i1}=0,\;\;
d_{i2}= \begin{cases}
1\;\;\text{if}\;\;i=\{1,...,250\} \\
0\;\;\text{otherwise}
\end{cases}
$$
$$
x_{i}=\begin{cases}
0.5+u_{i}\;\;\text{if}\;\;i=\{1,...,250\} \\
u_{i}\;\;\text{otherwise}
\end{cases}
\;\;\text{and}\;\;u_i \sim N(0,1)
$$

```{r simple_nonparellel}
library(lmtest)
library(sandwich)
# set seed
set.seed(11123)

# 500 units
N<-500
unit<-1:500

# Define treatment effect
tau<-4

# Treatment groups
d <- c(rep(0, N/2), rep(1, N/2))

# Adding the differential trend: 0.5*(t+1)*d
# DGP
X <- d*0.5+rnorm(N)
# Pre
Y_1 <- 5+0.2*X+0.3*rnorm(N)
# Post
Y_2 <- 5+2*(d+1)+0.2*X+tau*d+0.3*rnorm(N)

# DinD
(mean(Y_2[d == 1]) - mean(Y_1[d == 1])) - (mean(Y_2[d == 0]) - mean(Y_1[d == 0]))

# Two-way Fixed Effects
# Data prep
dind_data <- data.frame("Y"=c(Y_1, Y_2),
                        "Treat"=c(rep(0,N), d),
                        "Unit"=c(unit, unit),
                        "Time"=c(rep(1,N), rep(2,N)))

# Two-way FE regression
TWFE <- lm(Y ~ Treat + as.factor(Time) + as.factor(Unit), data = dind_data)
Results<-coeftest(TWFE, vcov=vcovHC)
Results[2,]
```

# What did we just estimate?
* Now, we no longer have
$$
\gamma_{it}=\gamma_{t}\;\text{for}\;\forall\;i.
$$
Thus,
$$
E(y_{i2}-y_{i1}|i \in T)-E(y_{i2}-y_{i1}|i \in C) \\
=E((\gamma_{i2}-\gamma_{i1})+\tau_i |i \in T)-E(\gamma_{i2}-\gamma_{i1}|i \in C) \\
=E(\tau_i|i \in T)+\underbrace{\{E(\gamma_{i2}-\gamma_{i1}|i \in T)-E(\gamma_{i2}-\gamma_{i1}|i \in C)\}}_{\text{Non-parallel trend bias}}.
$$
* In the previous example, we had
$$
\gamma_{it}=2(t-1)d_{it}
$$
which means
$$
\gamma_{i2}-\gamma_{i1}=2d_{i2}.
$$
Therefore, the "non-parallel trend bias" term becomes,
$$
E(2d_{i2}|i \in T)-E(2d_{i2}|i \in C)=2
$$
since $E(d_{i2}|i \in T)=1$ and $E(d_{i2}|i \in C)=0$.

# What if we have $T>2$?
* **Single treatment timing**: We can test for parellel-trend assumption if we have more than one "pre-treatment" periods. One way to do the pre-trend testing is to estimate
$$
y_{it}=\alpha_i+\gamma_t+\sum_t \delta_t \mathbb{1}_i (i \in T) + \varepsilon_{it}
$$
  + *Issues*: Can be under-powered and may lead to a biased estimate [@roth2019pre]
  + *Alternative approach*: "Honest" approach [@rambachan2019honest]
  + Functional forms? Theory?
* **Staggered treatment timing** and (dynamic) **heterogeneous treatment effects**: TWFE fails if the treatment is staggered AND the treatment effects are heterogeneous. Many recent papers discuss this issue. Two papers/approaches we will focus on
  + @de2020two
  + @callaway2020difference

# An example [@cai2016impact]
* Background
  1. The *experiment*: In 2003, the People's Insurance Company of China (PICC) started to offer a highly subsidized crop insurance program to tobacco producers in Guangchang county.
  2. @cai2016impact uses DID (and Triple difference) estimator to assess the impact of insurance provision on production and financail variables.
  3. Sample period: 2000 - 2008
  4. Here, let's focus on a production variable - Area of tobacco production.
  5. Disclaimer: I modified the original dataset -- kept only tobacco producers and restricted the sample to the households with all 9 year of data.
* Data set-up
```{r cai2016, results="hide"}
#libraries
library(tidyverse)
library(foreign)
library(plm)
library(lmtest)

#read data
cai_data<-read.dta("/Users/jisangyu/Dropbox/AGEC936/data/cai_AEJ_sample_balanced_tob_only.dta") %>%
  mutate(
    treatment=as_factor(treatment),
    hhno=as_factor(hhno),
    year=as_factor(year),
  )
```

* DID and TWFE give us equal estimates
```{r cai2016_2, collectcode=TRUE}
#Manual DID
#define subsets
pre_treated<-filter(cai_data, treatment==1, policy2==0)
pre_control<-filter(cai_data, treatment==0, policy2==0)
post_treated<-filter(cai_data, treatment==1, policy2==1)
post_control<-filter(cai_data, treatment==0, policy2==1)
#DID
(mean(post_treated$area_tob)-mean(pre_treated$area_tob))-(mean(post_control$area_tob)-mean(pre_control$area_tob))

#TWFE
TWFE<-plm(area_tob ~ did + as.factor(year),
          data=cai_data,
          index=c("hhno"),
          model="within")

coeftest(TWFE, vcov=function(x) vcovHC(x, cluster=c("group")))
```

# Testing for "pre-trend"
* Simply ploting means by year
```{r cai2016_mean, collectcode=TRUE}
ggplot(cai_data, aes(x=year, y=area_tob, color=treatment)) + 
stat_summary(aes(group = treatment), fun = mean, geom = 'line', size=1) 
```

* Regression-based: Estimate
$$
y_{it}=\alpha_i+\gamma_t+\sum_t \delta_t \mathbb{1}_i (i \in T) + \varepsilon_{it}
$$
and plot $\delta_t$.

```{r cai2016_3, collectcode=TRUE}
#Year x treatment
DT <- sapply(2000:2008, function(l) {
   1*( (cai_data$year == l) & (cai_data$treatment == 1) )
})
DT <-as.data.frame(DT)
colnames(DT)<-c(paste0("DT",2000:2008))
cai_data<-cbind.data.frame(cai_data,DT)

#Pre-trend regression
pretrend_reg <- cai_data %>% 
  plm(area_tob ~ year  + DT2001 + DT2002 + DT2003 + DT2004 + DT2005 + DT2006 + DT2007 + DT2008, 
      data=., model="within",
      index=c("hhno"))
results<-coeftest(pretrend_reg, vcov=function(x) vcovHC(x, cluster=c("group"))) 
results<-as.data.frame.matrix(results)

#plot
plot <- tibble(
  sd = results[[2]][9:16],
  mean = results[[1]][9:16],
  year = c(2001:2008))

plot %>% 
  ggplot(aes(x = year, y = mean)) + 
  ylab(expression(delta[t]))+
  geom_rect(aes(xmin=2003, xmax=2008, ymin=-Inf, ymax=Inf), fill = "cyan", alpha = 0.01)+
  geom_point()+
  geom_text(aes(label = year), hjust=-0.002, vjust = -0.03)+
  geom_hline(yintercept = 0) +
  geom_errorbar(aes(ymin = mean - sd*1.96, ymax = mean + sd*1.96), width = 0.2,
                position = position_dodge(0.05))
```

# Recent discussion related to "Staggered" treatment
* Different (staggered) treatment timings are nice! More variations!

* Can we still use TWFE?: Several recent papers show when and how TWFE can fail
  + @de2020two
  + @goodman2018difference (or [Mixtape's version of this](https://mixtape.scunning.com/difference-in-differences.html?panelset=r-code&panelset1=r-code2#twoway-fixed-effects-with-differential-timing))
  + [Guide by Callaway and Sant'Anna](https://bcallaway11.github.io/did/articles/multi-period-did.html)
  + And several other papers (e.g. @borusyak2017revisiting, @sun2020estimating)
  
* Alternatives to TWFE
  + @de2020two: uses a weighted-average of DID estimators.
  + @callaway2020difference: focuses on "group-time average treatment effect" and discusses different aggregation schemes of the group-time average treatment effect.

# @de2020two representation of TWFE estimator
* **Set-up** of @de2020two ($N_{g,t}=1$ version): Consider $N$ cross-sectional units, $i=1,...,N$, and $T>3$ time periods, $t=1,...,T$. Denote $y_{it}(d_{it})$ as  potential outcomes and the treatment status, $d_{it}$, can be zero or one. The treatment effect for each $(i,t)$ is
$$
\Delta_{i,t}=y_{it}(1)-y_{it}(0).
$$
(The ATT is $\Delta=E(y_{it}(1)-y_{it}(0)|d_{it}=1)$.)

* **TWFE regression**
Consider TWFE regression
$$
y_{it}=\alpha_i+\gamma_t+\tau d_{it}+\varepsilon_{it}.
$$
Do we have $E(\hat{\tau})$ converging to $E(\Delta_{i,t})$?

* **Theorem 1** of @de2020two (again, $N_{g,t}=1$ version)
$$
\tau=E\left(\frac{\sum_{(i,t):d_{it}=1}w_{it}\Delta_{it}}{\sum_i \sum_t d_{it}}\right)
$$
where
$$
w_{it}=\frac{\epsilon_{it}}{\frac{\sum_{(i,t):d_{it}=1}\epsilon_{it}}{\sum_i \sum_t d_{it}}},
$$
and 
$$
\epsilon_{it}=d_{it}-\bar{d}_i-\bar{d}_t+\bar{d}.
$$

# Why TWFE fails and when TWFE works?
* **Why TWFE fails?** $w_{it}$ does not necessary represent sample weights. Some $w_{it}$ can be **negative**!

* **If $\Delta_{it}=\Delta$ (i.e. homogeneous treatment effect),** we have 
$$
\tau=E\left(\frac{\sum_{(i,t):d_{it}=1}w_{it}\Delta_{it}}{\sum_i \sum_t d_{it}}\right)=\Delta
$$
TWFE works!

* **If $T=2$, $d_{i1}=0$ for all $i$, and $d_{i2}=1$ for some $i$,** we have $\epsilon_{i2}=\epsilon_{2}$ for $i$ with $d_{i2}=1$, and then
$$
w_{i2}=\frac{\epsilon_{2}}{\frac{\sum_{i:d_{i2}=1}\epsilon_{2}}{\sum_i d_{i2}}}=1
$$
TWFE works!

# @de2020two $DID_M$ estimator
* **The intuition**: Use the weighted average of i) "treatment effects" in groups who switch-in from $d_{it-1}=0$ to $d_{it}=1$ and ii) "treatment effects" in groups who switch-out from $d_{it-1}=1$ to $d_{it}=0$. For i), the benchmark group is $d_{it-1}=d_{it}=0$ and for ii), the benchmark group is $d_{it-1}=d_{it}=1$. 

* $DID_M$ estimator
$$
DID_M=\sum_{t=2} \left(\theta_{\text{switch-in},t}DID_{\text{switch-in},t}+\theta_{\text{switch-out},t}DID_{\text{switch-out},t}\right)
$$

# @callaway2020difference: Group-time average treatment effect

# @callaway2020difference: Aggregation

# Few treated and many controls

# Synthetic control methods

# An example [@abadie2003economic]

```{r basque, results="hide"}
library(Synth)
data(basque)
#Data preparation
dataprep.out <- dataprep(
foo = basque,
predictors = c("school.illit", "school.prim", "school.med",
"school.high", "school.post.high", "invest"),
predictors.op = "mean",
time.predictors.prior = 1964:1969,
special.predictors = list(
list("gdpcap", 1960:1969 , "mean"),
list("sec.agriculture", seq(1961, 1969, 2), "mean"),
list("sec.energy", seq(1961, 1969, 2), "mean"),
list("sec.industry", seq(1961, 1969, 2), "mean"),
list("sec.construction", seq(1961, 1969, 2), "mean"),
list("sec.services.venta", seq(1961, 1969, 2), "mean"),
list("sec.services.nonventa", seq(1961, 1969, 2), "mean"),
list("popdens", 1969, "mean")),
dependent = "gdpcap",
unit.variable = "regionno",
unit.names.variable = "regionname",
time.variable = "year",
treatment.identifier = 17,
controls.identifier = c(2:16, 18),
time.optimize.ssr = 1960:1969,
time.plot = 1955:1997)
#Further variable consolidation and manipulation following Abadie et al 2011 (Journal of Statistical Software)
dataprep.out$X1["school.high",] <- dataprep.out$X1["school.high",] +
dataprep.out$X1["school.post.high",]
dataprep.out$X1 <- as.matrix(dataprep.out$X1[
-which(rownames(dataprep.out$X1) == "school.post.high"),])
dataprep.out$X0["school.high",] <- dataprep.out$X0["school.high",] +
dataprep.out$X0["school.post.high",]
dataprep.out$X0 <- dataprep.out$X0[
-which(rownames(dataprep.out$X0) == "school.post.high"),]
lowest <- which(rownames(dataprep.out$X0) == "school.illit")
highest <- which(rownames(dataprep.out$X0) == "school.high")
dataprep.out$X1[lowest:highest,] <-
(100 * dataprep.out$X1[lowest:highest,]) /
sum(dataprep.out$X1[lowest:highest,])
dataprep.out$X0[lowest:highest,] <-
100 * scale(dataprep.out$X0[lowest:highest,], center = FALSE,
scale = colSums(dataprep.out$X0[lowest:highest,]))
#Synth estimation
synth.out <- synth(data.prep.obj = dataprep.out, method = "BFGS")
synth.tables <- synth.tab(dataprep.res = dataprep.out,synth.res = synth.out)
hat.w.scm1<-synth.tables$tab.w[,1]
#Observed and Synthetic Basque
obs.Y.1t<-dataprep.out$Y1
hat.Y.1t.scm1<-(dataprep.out$Y0)%*%hat.w.scm1
```
```{r basque_results, collectcode=TRUE}
#Weights
synth.tables$tab.w
#Plot
Year<-1955:1997
plot(Year,obs.Y.1t,ylim=c(3,12),ylab="real per-capita GDP(1986 USD, thousand)",type='l',lwd=2)
abline(v=1970,lty=3,col=1)
lines(Year,hat.Y.1t.scm1,col=4,lwd=2,lty=1)
```

# Placebo test
* Test with other region (Cataluna)
```{r placebo, collectcode=TRUE, results="hide"}
dataprep.out <- dataprep(
foo = basque,
predictors = c("school.illit", "school.prim", "school.med",
"school.high", "school.post.high", "invest"),
predictors.op = "mean",
time.predictors.prior = 1964:1969,
special.predictors = list(
list("gdpcap", 1960:1969 , "mean"),
list("sec.agriculture", seq(1961, 1969, 2), "mean"),
list("sec.energy", seq(1961, 1969, 2), "mean"),
list("sec.industry", seq(1961, 1969, 2), "mean"),
list("sec.construction", seq(1961, 1969, 2), "mean"),
list("sec.services.venta", seq(1961, 1969, 2), "mean"),
list("sec.services.nonventa", seq(1961, 1969, 2), "mean"),
list("popdens", 1969, "mean")),
dependent = "gdpcap",
unit.variable = "regionno",
unit.names.variable = "regionname",
time.variable = "year",
treatment.identifier = 10,
controls.identifier = c(2:9, 11:16, 18),
time.optimize.ssr = 1960:1969,
time.plot = 1955:1997)
#Further variable consolidation and manipulation following Abadie et al 2011 (Journal of Statistical Software)
dataprep.out$X1["school.high",] <- dataprep.out$X1["school.high",] +
dataprep.out$X1["school.post.high",]
dataprep.out$X1 <- as.matrix(dataprep.out$X1[
-which(rownames(dataprep.out$X1) == "school.post.high"),])
dataprep.out$X0["school.high",] <- dataprep.out$X0["school.high",] +
dataprep.out$X0["school.post.high",]
dataprep.out$X0 <- dataprep.out$X0[
-which(rownames(dataprep.out$X0) == "school.post.high"),]
lowest <- which(rownames(dataprep.out$X0) == "school.illit")
highest <- which(rownames(dataprep.out$X0) == "school.high")
dataprep.out$X1[lowest:highest,] <-
(100 * dataprep.out$X1[lowest:highest,]) /
sum(dataprep.out$X1[lowest:highest,])
dataprep.out$X0[lowest:highest,] <-
100 * scale(dataprep.out$X0[lowest:highest,], center = FALSE,
scale = colSums(dataprep.out$X0[lowest:highest,]))
#Synth estimation
synth.out <- synth(data.prep.obj = dataprep.out, method = "BFGS")
synth.tables <- synth.tab(dataprep.res = dataprep.out,synth.res = synth.out)
hat.w.scm1<-synth.tables$tab.w[,1]
#Observed and Synthetic Cataluna
obs.Y.1t<-dataprep.out$Y1
hat.Y.1t.scm1<-(dataprep.out$Y0)%*%hat.w.scm1
```
```{r placebo_results, collectcode=TRUE}
#Weights
synth.tables$tab.w
#Plot
Year<-1955:1997
plot(Year,obs.Y.1t,ylim=c(3,12),ylab="real per-capita GDP(1986 USD, thousand)",type='l',lwd=2)
abline(v=1970,lty=3,col=1)
lines(Year,hat.Y.1t.scm1,col=4,lwd=2,lty=1)
```

# Synthetic control: Things to consider

# Next week

# References

